# 系统架构

## 概述

炒币的猫交易系统采用微服务架构设计，确保系统的高可用性、可扩展性和维护性。

## 架构图

```
┌─────────────────────────────────────────────────────────────┐
│                         用户界面层                           │
│                    (Web Dashboard / API)                     │
└─────────────────────────────────────────────────────────────┘
                               ▼
┌─────────────────────────────────────────────────────────────┐
│                         API 网关                             │
│                    (认证 / 路由 / 限流)                       │
└─────────────────────────────────────────────────────────────┘
                               ▼
┌──────────────┬──────────────┬──────────────┬────────────────┐
│  交易服务    │  数据服务    │  策略服务    │   风控服务     │
│              │              │              │                │
│ • 订单管理   │ • 实时数据   │ • 策略执行   │ • 风险监控    │
│ • 执行引擎   │ • 历史数据   │ • 信号生成   │ • 仓位管理    │
│ • 账户管理   │ • 数据分析   │ • 回测系统   │ • 止损止盈    │
└──────────────┴──────────────┴──────────────┴────────────────┘
                               ▼
┌─────────────────────────────────────────────────────────────┐
│                         数据层                               │
│              (Redis / PostgreSQL / TimescaleDB)              │
└─────────────────────────────────────────────────────────────┘
                               ▼
┌─────────────────────────────────────────────────────────────┐
│                      外部交易所 API                          │
│           (Binance / OKX / Huobi / Coinbase)                │
└─────────────────────────────────────────────────────────────┘
```

## 核心组件

### 1. 交易服务 (Trading Service)

负责所有交易相关操作：
- **订单管理**: 创建、修改、取消订单
- **执行引擎**: 智能订单路由和执行
- **账户管理**: 多账户支持和余额管理

### 2. 数据服务 (Data Service)

提供市场数据：
- **实时数据流**: WebSocket 推送实时行情
- **历史数据**: K线、成交记录等历史数据存储
- **数据聚合**: 多交易所数据聚合和标准化

### 3. 策略服务 (Strategy Service)

交易策略的核心：
- **策略引擎**: 执行各类交易策略
- **信号系统**: 生成买卖信号
- **回测平台**: 历史数据回测验证

### 4. 风控服务 (Risk Service)

风险管理：
- **实时监控**: 监控仓位和风险指标
- **自动止损**: 触发条件自动平仓
- **资金管理**: 动态调整仓位大小

## 技术栈

- **编程语言**: Python 3.9+, Node.js
- **框架**: FastAPI, Express.js
- **数据库**: PostgreSQL, Redis, TimescaleDB
- **消息队列**: RabbitMQ / Kafka
- **容器化**: Docker, Kubernetes
- **监控**: Prometheus, Grafana

## 部署模式

### 开发环境
- Docker Compose 单机部署
- 本地数据库实例

### 生产环境
- Kubernetes 集群部署
- 高可用数据库集群
- 负载均衡和自动扩缩容

## 安全措施

- API 密钥加密存储
- SSL/TLS 加密通信
- IP 白名单
- 请求签名验证
- 操作审计日志